= ElasticData.io - платформа автоматичного збору, трансформації і аналізу данних

== Про палатформу

Перелік можливостей:

* *Збирати данні з веб майданчиків*
** Користуючись API
** Використовуючи прості UI інструменти на сайті link:++http://app.elasticdata.io++[app.elasticdata.io]
* *Транформувати зібрані данні*
** Використовувати регулярні вирази для заміни тексту
** Додаткові функції для роботи с текстом
* *Аналізувати данні*
** Будувати різноманітні графіки, діаграмми використовуючи прості UI інструменти
** Будувати графіки обєднавши данні з різних сайтів
* _Спостерігати за зміною данних на веб сайтах_
** _Підписатися на зміну данних_
** _Інтеграція по API_
** _Інтеграція через telegram bot_
* _Публікація данних, або емуляція дій людини_
** _Авторизація на сайті_
** _Підписка, лайки, коментарі, тощо_
** _Перепублікації статей_
** _Інше..._

== Початок роботи

WARNING: Цей розділ на модерації

== Перелік інструкцій (команд) для збору данних

=== 1. Url - завантажити сторінку за url адресою

TIP: Команда *url* дозволяє завантажити будь-яку сторінку за вказаною веб адресою.

.Приклак команди url в JSON форматі
[source,json]
----
{
    "cmd": "url", <1>
    "params": {
        "urls": ["https://google.com.ua"], <2>
        "timeout": 8 <3>
    }
}
----
<1> Назва команди
<2> Адреса web сторінки для переходу
<3> Максимальний час очікування завантаження сторінки в секундах (8 сек за замовчуванням)

=== 2. GetText - копіювання тексту з елементу, або атрибуту

TIP: Команда *getText* дозволяє скопіювати текс елемента, або будь який атрибут з елемента на сторінці.

.Приклад елемента на сторінці
====
[source,html]
----
<div id="app">
    <a class="logo" href="//site.com">site.com</a>
</div>
----
====

.Приклак конфігурації команди getText для #вибору тексту# в JSON форматі
====
[source,json]
----
{
    "cmd": "getText",
    "params": {
        "selector": "#app a.logo", <1>
        "key": "external_link", <2>
        "timeout": 4 <3>
    }
}
----
<1> CSS, або XPATH селектор елементу
<2> Назва ключа, куди буде скопійовано значення з елементу
<3> Максимальний час очікування елемента на сторінці

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "external_link": "site.com"
    }
]
----
====

.Приклак конфігурації команди getText для #вибору значення атрибуту# href в JSON форматі
====
[source,json]
----
{
    "cmd": "getText",
    "params": {
        "selector": "#app a.logo", <1>
        "key": "external_link", <2>
        "attribute": "href", <3>
        "prefix": "https:", <4>
        "timeout": 4 <5>
    }
}
----
<1> CSS, або XPATH селектор елементу
<2> Назва ключа, куди буде скопійовано значення з елементу
<3> Якщо вказано - буде копіювати значення вказанно атрибуту елементу (наприклад ```<a href=*"http://site.com"*>site.com</a>```)
<4> Якщо вказано - буде додано префікс-слово, до значення вибраних данних
<5> Максимальний час очікування елемента на сторінці

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "external_link": "https://site.com"
    }
]
----
====

=== 3. GetHtml - копіювання html з елементу

TIP: Команда *getHtml* дозволяє скопіювати html з елемента на сторінці.

.Приклад елемента на сторінці
====
[source,html]
----
<div id="app">
    <a class="logo" href="//site.com">site.com</a>
</div>
----
====

.Приклак конфігурації команди getHtml в JSON форматі
====
[source,json]
----
{
    "cmd": "getHtml",
    "params": {
        "selector": "#app", <1>
        "key": "app_html_text", <2>
        "timeout": 4 <3>
    }
}
----
<1> CSS, або XPATH селектор елементу
<2> Назва ключа, куди буде скопійовано html значення з елементу
<3> Максимальний час очікування елемента на сторінці

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "app_html_text": "<a class=\"logo\" href=\"//site.com\">site.com</a>"
    }
]
----
====

=== 4. GetUrl - копіювання поточної адреси сайту

TIP: Команда *getUrl* дозволяє скопіювати веб адресу поточної сторінки.

.Приклак конфігурації команди getUrl в JSON форматі
====
[source,json]
----
{
    "cmd": "url",
    "params": {
        "urls": ["http://google.com.ua"], <1>
    }
},
{
    "cmd": "getUrl",
    "params": {
        "key": "current_url", <2>
        "timeout": 4 <3>
    }
}
----
<1> Веб адреса сторінки, яку потрібно завантажити
<2> Назва ключа, куди буде скопійовано веб адресу поточної сторінки
<3> Максимальний час очікування

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "current_url": "http://google.com.ua"
    }
]
----
====

=== 5. PutText - вставити текст в елемент

TIP: Команда *putText* дозволяє вставити текст в елемент #<input /># або #<textarea />#.
Це може буди необхідно, наприклад при авторизації на сайті.

.Приклад елемента на сторінці, в який треба вставити текст
====
[source,html]
----
<form id="login">
    <input class="login" />
    <input id="password" type="password" />
    <button type="submit">login</button>
</div>
----
====


.Приклак конфігурації команди putText в JSON форматі
====
[source,json]
----
{
    "cmd": "putText",
    "params": {
        "selector": ".login", <1>
        "text": "supervisor", <2>
        "timeout": 3 <3>
    }
},
{
    "cmd": "putText",
    "params": {
        "selector": "#password",
        "text": "my_password"
    }
}
----
<1> CSS, або XPATH селектор елементу, в який необхідно вставити текст
<2> Текс який необхідно вставити
<3> Максимальний час очікування елемента на сторінці
====

=== 6. Click - javascript клік на елемент

TIP: Команда *click* дозволяє зробити лівий клік миші на будь-якому елементі на сторінці.

WARNING: Ця команда насправді емулює клік, виконуючи javascript команду .click() на елементі.
За рахунок чого працію швидко.
Якщо вам потрібне справжнє наведення курсору і браузерний клік, дивіться команду #nativeClick#

.Приклад елемента на сторінці, в який треба клікнути
====
[source,html]
----
<form id="login">
    <input class="login" />
    <input id="password" type="password" />
    <button type="submit">login</button>
</div>
----
====

.Приклак конфігурації команди click в JSON форматі
====
[source,json]
----
{
    "cmd": "click",
    "params": {
        "selector": "form#login button[type=\"submit\"]", <1>
        "timeout": 3 <2>
    }
}
----
<1> CSS, або XPATH селектор елементу, в який необхідно клікнути
<2> Максимальний час очікування елемента на сторінці
====

=== 7. NativeClick - клік на елемент з наведенням курсору

TIP: Команда *nativeClick* дозволяє зробити лівий клік миші на будь-якому елементі на сторінці.

.Приклад елемента на сторінці, в який треба клікнути
====
[source,html]
----
<form id="login">
    <input class="login" />
    <input id="password" type="password" />
    <button type="submit">login</button>
</div>
----
====

.Приклак конфігурації команди nativeClick в JSON форматі
====
[source,json]
----
{
    "cmd": "nativeClick",
    "params": {
        "selector": "form#login button[type=\"submit\"]", <1>
        "timeout": 3 <2>
    }
}
----
<1> CSS, або XPATH селектор елементу, в який необхідно клікнути
<2> Максимальний час очікування елемента на сторінці
====

=== 8. Hover - навести курсор на елемент

TIP: Команда *hover* дозволяє навести курсор миші на елемент.

.Приклад елемента на сторінці, в який треба навести курсор миші
====
[source,html]
----
<div class="img">
    <img src="http://site.com/image.jpg" />
</div>
----
====

.Приклак конфігурації команди hover в JSON форматі
====
[source,json]
----
{
    "cmd": "hover",
    "params": {
        "selector": ".img", <1>
        "timeout": 3 <2>
    }
}
----
<1> CSS, або XPATH селектор елементу, на який треба навести курсор миші
<2> Максимальний час очікування елемента на сторінці
====

=== 9. Js - виконати будь-який javascript на сторінці

TIP: Команда *js* дозволяє виконати будь-який javascript на сторінці.

.Фрагмент сторінки, в якій треба вибрати значення всіх ссилок
====
[source,html]
----
<div>
    <a href="http://site.com/link1">link 1</a>
    <a href="http://site.com/link2">link 2</a>
    <a href="http://site.com/link3">link 3</a>
</div>
----
====

.Приклак конфігурації команди js в JSON форматі
====
[source,json]
----
{
    "cmd": "js",
    "params": {
        "script": "return Array.from(document.querySelectorAll('a')).map(x => x.getAttribute('href')).join(',')", <1>
        "key": "links" <2>
        "timeout": 3 <3>
    }
}
----
<1> Javascript сценірй, який буде виконуватися на сторінці. Вибирає всі ссилки на сторінці
<2> Назва ключа, куди буде скопійовано результат роботи javascript сценарія
<3> Максимальний час очікування роботи javascript сценарія

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "links": "http://site.com/link1,http://site.com/link2,http://site.com/link3"
    }
]
----
====

=== 10. Loop - цикл

TIP: Команда *loop* дозволяє, в циклі, повторювати будь-які інструкції (команди).

.Фрагмент сторінки, в якій треба вибрати значення всіх ссилок за допомогою команди loop
====
[source,html]
----
<ul class="links">
    <li>
        <a href="http://site.com/link1">link 1</a>
    </li>
    <li>
        <a href="http://site.com/link2">link 2</a>
    </li>
    <li>
        <a href="http://site.com/link3">link 3</a>
    </li>
</ul>
----
====

.Приклак конфігурації команди loop в JSON форматі
====
[source,json]
----
{
    "cmd": "loop",
    "params": {
        "iteration": 0, <1>
        "commands": [ <2>
            {
                "cmd": "click",
                "params": {
                    "selector": ".links li$i a"
                }
            },
            {
                "cmd": "getText",
                "params": {
                    "selector": ".links li$i a", <3>
                    "key": "link_text" <4>
                }
            }
        ]
    }
}
----
<1> Початковий індекс команди loop. #0# за замовчуванням.
<2> Список команд, які будуть виконуватися по колу
<3> CSS, або XPATH селектор для команди getText.
Зверніть увагу, абревіатура #$i# дозволяє привязатися до індексу команди loop.
Індекс починаєтся з #0#, за умови що не вказана властивість #iteration# для команди loop.
<4> Назва ключа, куди буде скопійовано текст ссилки

.Дані на виході (файл data.json)
[source,json]
----
[
    {
        "link_text": "link 1"
    },
    {
        "link_text": "link 2"
    },
    {
        "link_text": "link 3"
    }
]
----
====

WARNING: Зверніть увагу, що команди в секціі #commands#,
будуть виконуватися поки одна із команд сгенерує помилку.
Наприклад внутрішня команда getText не знайде елемент на сторінці з індексом 3.
І тоді відбудется перехід до наступного сусіда команди loop

=== 11. Condition - умова

TIP: Команда *condition* дозволяє робити різні гілки розвитку команд,
в залежності від виконання внутрішньої команди #ifCommand#.

TIP: Корисна коли елемент може буди відсутній на сторінці,
або сторінка відображаєтся по різному в залежності від різних умов

.Приклак конфігурації команди condition в JSON форматі
====
[source,json]
----
{
    "cmd": "condition",
    "params": {
        "ifCommand": { <1>
            "cmd": "waitElement",
            "params": {
                "selector": ".login-btn"
            }
        },
        "trueCommands": [ <2>
            {
                "cmd": "click",
                "params": {
                    "selector": ".login-btn"
                }
            }
        ],
        "falseCommands": [ <3>

        ]
    }
}
----
<1> Команда-умова. Якщо ця команда виконаєтся з успіхом,
то далі будуть виконуватися команди у блоці #trueCommands#.
А якщо #ifCommand# сгенерує помилку, то будуть запущенні команди з блоку #falseCommands#.
<2> Команди які запустяться якщо ifCommand виконаєтся з успіхом
<3> Команди які запустяться якщо ifCommand виконаєтся з помилкою
====

WARNING: Зверніть увагу, що властивості #trueCommands#, або #falseCommands# можуть бути пустими

=== 12. WaitElement - чекати появи елемента на сторінці

TIP: Команда *waitElement* дозволяє чекати появи елемента на сторінці.

.Приклак команди waitElement в JSON форматі
====
[source,json]
----
{
    "cmd": "waitElement",
    "params": {
        "selector": ".login-btn", <1>
        "timeout": 4 <2>
    }
}
----
<1> CSS, або XPATH селектор елементу
<2> Максимальний час очікування елемента на сторінці в секундах (4 сек за замовчуванням)
====

=== 13. Wait - зачекати n-секунд

TIP: Команда *wait* дозволяє зачекати n-секунд.

.Приклак команди wait в JSON форматі
====
[source,json]
----
{
    "cmd": "wait",
    "params": {
        "timeout": 1 <1>
    }
}
----
<1> Час очікування в секундах
====

=== 14. Чекати зміни html на елементі

WARNING: Цей розділ на модерації

=== 15. Чекати зміни кількості елементів

WARNING: Цей розділ на модерації

=== 16. Переключити контекст на iframe

WARNING: Цей розділ на модерації

=== 17. Зробити скрішот екрану

WARNING: Цей розділ на модерації



